\documentclass{article}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{natbib}         % bibliography \usepackage{apalike}
\usepackage{xcolor}
\usepackage{graphicx}

\title{REINFORCE Variants}

\author{
Sotetsu KOYAMADA
}

\begin{document}

\maketitle

\begin{abstract}
We summarize the famous REINFORCE algorithm variants.
\end{abstract}

\section{Notation}
Sutton book~\cite{Sutton2018-ij}.

\section{REINFORCE variants}

Policy gradient $\nabla_\theta J(\theta)$ is defined by

\begin{eqnarray}
\nabla_\theta J(\theta) 
= \mathbb{E} \Biggl[ \nabla_\theta \log \pi_\theta (a|s) \,\sum_{t^\prime=1}^T r(s, a) \Biggr]
\end{eqnarray}

\subsection{Vanilla REINFORCE}

\begin{eqnarray}
\nabla_\theta J(\theta) 
&\approx& \frac{1}{N} \sum_{n=1}^{N} \sum_{t=1}^{T} \Biggl(\, \sum_{t^\prime=1}^T r(s_{n, t^\prime}, a_{n, t^\prime}) \Biggr) \nabla_\theta \log \pi_\theta (a_{n, t}|s_{n, t}) \\
&=& \frac{1}{N} \sum_{n=1}^{N} \Biggl(\, \sum_{t^\prime=1}^T r(s_{n, t^\prime}, a_{n, t^\prime}) \Biggr)\sum_{t=1}^{T} \nabla_\theta \log \pi_\theta (a_{n, t}|s_{n, t}) \\
&=& \frac{1}{N} \sum_{n=1}^{N} \mathcal{R}_n \sum_{t=1}^{T} \nabla_\theta \log \pi_\theta (a_{n, t}|s_{n, t}) 
\end{eqnarray}
where $\mathcal{R}_{n} = \sum_{t^\prime=1}^T r(s_{n, t^\prime}, a_{n, t^\prime})$.

\subsection{REINFORCE with Future Return}

\begin{eqnarray}
\nabla_\theta J(\theta) 
&\approx& \frac{1}{N} \sum_{n=1}^{N} \sum_{t=1}^{T}  \Biggl(\, \sum_{{\color{red}{t^\prime=t}}}^{T} r(s_{n, t^\prime}, a_{n, t^\prime}) \Biggr) \nabla_\theta \log \pi_\theta (a_{n, t}|s_{n, t})\\
&=& \frac{1}{N} \sum_{n=1}^{N} \sum_{t=1}^{T} \mathcal{R}_{n, {\color{red}{t}}} \nabla_\theta \log \pi_\theta (a_{n, t}|s_{n, t}) 
\end{eqnarray}

where, $\mathcal{R}_{n, t} = \sum_{t^\prime=t}^T r(s_{n, t^\prime}, a_{n, t^\prime})$.


\subsection{REINFORCE with Entropy Bonus}
\subsection{REINFORCE with Baselines}

\begin{eqnarray}
\nabla_\theta J(\theta) 
\approx \frac{1}{N} \sum_{n=1}^{N} \Biggl(\mathcal{R}_n {\color{red}{- \frac{1}{N} \sum_{n^\prime=1}^N \mathcal{R}_n }} \Biggr)\sum_{t=1}^{T} \nabla_\theta \log \pi_\theta (a_{n, t}|s_{n, t}) 
\end{eqnarray}

For the future return case, 

\begin{eqnarray}
\nabla_\theta J(\theta) 
\approx \frac{1}{N} \sum_{n=1}^{N} \sum_{t=1}^{T} \Biggl(\mathcal{R}_{n, t} {\color{red}{- \frac{1}{N} \sum_{n^\prime=1}^N \mathcal{R}_{n^\prime, t} }} \Biggr)  \nabla_\theta \log \pi_\theta (a_{n, t}|s_{n, t}) 
\end{eqnarray}


\bibliographystyle{apalike}
\bibliography{reference}

\end{document}
